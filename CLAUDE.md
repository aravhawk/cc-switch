# cc-switch Project Documentation

## Overview

`cc-switch` is a CLI tool for managing multiple Claude Code profiles by swapping `~/.claude/settings.json` files.

## Project Structure

```
cc-switch/
├── src/
│   ├── index.ts         # CLI entry point with commander and @clack/prompts
│   ├── profiles.ts      # Core profile operations (switch, create, delete, rename, list)
│   ├── state.ts         # State management for tracking active profile
│   ├── types.ts         # TypeScript type definitions
│   ├── paths.ts         # Path utilities for ~/.claude and ~/.cc-switch
│   └── validation.ts    # Profile name validation
├── dist/                # Build output (generated by tsup)
├── package.json         # Package metadata and dependencies
├── tsconfig.json        # TypeScript configuration
├── tsup.config.ts       # Build configuration
└── PLAN.md             # Original implementation plan
```

## Key Implementation Details

### Profile Storage

- Profiles are stored at `~/.cc-switch/profiles/<name>/settings.json`
- Active profile is tracked in `~/.cc-switch/state.json`
- All file operations use atomic writes (write to temp file, then rename)

### Switch Workflow

1. Mirror current `~/.claude/settings.json` to active profile's directory
2. Copy target profile's `settings.json` to `~/.claude/settings.json`
3. Update `state.json` with new active profile and timestamp
4. If target equals active, mirror and exit with "already active" message

### Validation Rules

Profile names must:
- Be non-empty
- Match regex: `^[A-Za-z0-9-_]+$`
- Not contain `..`, `/`, or `\`

### Error Handling

- Missing `~/.claude/settings.json` shows setup instructions
- Cannot delete active profile (must switch first)
- Clear, actionable error messages for all failures
- Exit code 0 on success, 1 on errors

## Build System

- Uses `tsup` for fast, simple builds
- Target: Node 18+, ESM format
- Shebang automatically added to `dist/index.js`
- Output is executable and ready for npm publishing

## Dependencies

- `@clack/prompts`: Interactive CLI prompts
- `commander`: Command-line argument parsing
- No runtime dependencies on Claude Code itself

## Constraints

- CLI-only (no GUI)
- No Next.js (intentional exception to user's general preference)
- Uses `pnpm` for package management
- Minimal use of non-ASCII characters
